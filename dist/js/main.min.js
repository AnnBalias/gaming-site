document.addEventListener("DOMContentLoaded",()=>{new FridayNightFunkin});class FridayNightFunkin{constructor(){this.data=null,this.init()}async init(){try{this.setupGlobalErrorHandlers(),await this.loadData(),this.setupEventListeners(),this.renderContent(),this.initializeComponents(),this.initializeYYGGames()}catch(e){}}setupGlobalErrorHandlers(){window.addEventListener("unhandledrejection",e=>{e.reason&&"string"==typeof e.reason&&window.EnvironmentHelpers?.shouldSilentFail(e.reason),e.preventDefault()}),window.addEventListener("error",e=>{var t=e.message||"",a=e.filename||"";return window.EnvironmentHelpers?.shouldSilentFail(t)||window.EnvironmentHelpers?.shouldSilentFail(a)||t.includes("Content Security Policy")?(e.preventDefault(),!1):void 0}),document.addEventListener("securitypolicyviolation",e=>{e.preventDefault()})}async loadData(){try{try{var e=window.EnvironmentHelpers?.getBackendUrl()||"http://localhost:9998",a=await fetch(e+"/config",{method:"GET",headers:{"Content-Type":"application/json"},signal:AbortSignal.timeout(3e3)});if(a.ok)return void(this.data=await a.json())}catch(e){window.EnvironmentHelpers?.isDevelopment()&&console.warn("Backend not available, using local data")}var n,o=null;let t=!1;for(n of["data.json","./data.json","/data.json","../data.json"])try{let e=new AbortController;var i=setTimeout(()=>e.abort(),5e3),o=await fetch(n,{signal:e.signal});if(clearTimeout(i),o.ok){this.data=await o.json(),t=!0;break}}catch(e){continue}if(!t)try{this.data=await this.loadDataWithXHR()}catch(e){throw new Error("Failed to load data from all methods")}}catch(e){this.data={meta:{title:"CyberStrike Arena - Ритмічна музична битва",description:"Пориньте у божевільні ритми та надзвичайні дуелі.",keywords:"cyberstrike arena, ритм гра, музична гра, танцювальна гра, битва, музика"},header:{logo:{text:"CyberStrike",accent:"Arena"},navigation:{home:"Головна",game:"Грати зараз",howToPlay:"Як грати",news:"Новини",contact:"Контакти"}},hero:{badge:"Нова гра",title:"CyberStrike Arena",description:"Пориньте у божевільні ритми та надзвичайні дуелі.",actions:{playNow:"Грати зараз",howToPlay:"Як грати"},features:[{icon:"music",text:"Ритмічна музика"},{icon:"energy",text:"Швидкі дуелі"},{icon:"gamepad",text:"Турніри"}],gamePreview:{title:"Попередній перегляд",stats:{rating:{value:"4.8",label:"Рейтинг"},players:{value:"10K+",label:"Гравців"},songs:{value:"50+",label:"Пісень"}}}},game:{title:"Грати зараз",description:"Натисніть кнопку, щоб почати гру",startButton:"Почати гру"},playGame:{fullscreenButton:"Повноекранний режим",exitFullscreenButton:"Згорнути",iframe:{src:"https://html5.gamemonetize.co/8g62o78s1wjhsiu54xlmql32h7pagsek/",width:"720",height:"1280"}},howToPlay:{title:"Як грати",description:"Ознайомтеся з правилами гри",steps:[{step:"1",title:"Вибирайте пісню",description:"Оберіть улюблену пісню з колекції"},{step:"2",title:"Натискайте стрілки",description:"Натискайте стрілки в такт з битами"},{step:"3",title:"Залишайтесь в ритмі",description:"Тримайте ритм, щоб набрати бали"}]},reviews:{title:"Відгуки гравців",description:"Що говорять про нас гравці",reviews:[{player:"Анна",rating:5,comment:"Чудова гра! Дуже захоплююча музика.",avatar:"assets/images/avatar1.jpg"},{player:"Максим",rating:4,comment:"Гарний геймплей, але можна більше пісень.",avatar:"assets/images/avatar2.jpg"}]},news:{title:"Останні новини",description:"Будьте в курсі останніх подій та анонсів",articles:[{id:1,title:"Нова пісня додана",excerpt:"Додано нову захоплюючу пісню до колекції",content:"Ми раді повідомити, що до колекції додано нову захоплюючу пісню. Спробуйте її прямо зараз!",image:"assets/images/post.jpg",date:"2025-01-15"},{id:2,title:"Оновлення інтерфейсу",excerpt:"Покращений користувацький інтерфейс",content:"Ми оновили інтерфейс гри для кращого досвіду користувача. Тепер все виглядає ще краще!",image:"assets/images/post2.jpg",date:"2025-01-10"}]},contact:{title:"Зв'яжіться з нами",description:"Маєте питання? Напишіть нам!",info:{email:"support@cyberstrikearena.com",address:"м. Київ, вул. Вигадана, 123"},form:{name:{label:"Ім'я",placeholder:"Введіть ваше ім'я"},email:{label:"Email",placeholder:"Введіть ваш email"},message:{label:"Повідомлення",placeholder:"Введіть ваше повідомлення"},submit:"Надіслати",sending:"Надсилання...",success:"Повідомлення успішно надіслано!",error:"Помилка при надсиланні повідомлення."}},footer:{brand:{text:"CyberStrike",accent:"Arena"},description:"Найкраща ритмічна музична гра для всіх вікових груп.",sections:{game:{title:"Гра",links:[{text:"Грати зараз",href:"#game"},{text:"Як грати",href:"#how-to-play"},{text:"Правила",href:"#rules"}]},community:{title:"Спільнота",links:[{text:"Discord",href:"#",external:!0},{text:"Telegram",href:"#",external:!0},{text:"Форум",href:"#",external:!0}]},legal:{title:"Правові питання",links:[{text:"Умови використання",href:"terms.html"},{text:"Політика конфіденційності",href:"privacy.html"},{text:"Файли cookie",href:"cookies.html"}]}},copyright:"© 2025 CyberStrike Arena. Всі права захищені."},cookieBar:{message:"Ми використовуємо файли cookie для покращення вашого досвіду.",accept:"Прийняти",decline:"Відхилити"}}}}setupEventListeners(){let t=document.querySelector(".header__mobile-toggle"),a=document.querySelector(".mobile-menu");var e=document.querySelector(".mobile-menu__close"),n=document.querySelector(".mobile-menu__overlay"),e=(t&&a&&(t.addEventListener("click",()=>{this.openMobileMenu(t,a)}),e&&e.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),this.closeMobileMenu(t,a)}),n&&n.addEventListener("click",()=>{this.closeMobileMenu(t,a)}),document.querySelectorAll(".mobile-menu__link").forEach(e=>{e.addEventListener("click",()=>{this.closeMobileMenu(t,a)})}),document.addEventListener("keydown",e=>{"Escape"===e.key&&a.classList.contains("active")&&this.closeMobileMenu(t,a)})),document.querySelectorAll('a[href^="#"]')),n=document.querySelectorAll("#play-now-btn, #watch-trailer-btn");let o=t=>{try{var e,a,n,o=document.querySelector(t);o&&(a=(e=document.querySelector(".header"))?e.offsetHeight:0,n=o.offsetTop-a,window.scrollTo({top:n,behavior:"smooth"}))}catch(e){try{var i=document.querySelector(t);i&&i.scrollIntoView()}catch(e){}}};e.forEach(t=>{t.addEventListener("click",e=>{e.preventDefault(),o(t.getAttribute("href"))})}),n.forEach(t=>{t.addEventListener("click",e=>{e.preventDefault(),"play-now-btn"===t.id?o("#game"):"watch-trailer-btn"===t.id&&o("#how-to-play")})}),this.setupCookieBar(),this.setupGameIframe(),this.setupNewsModals(),this.setupContactForm(),this.setupHeaderScroll(),this.setupNavigationHighlighting()}setupCookieBar(){let e=document.getElementById("cookie-bar");var t=document.getElementById("cookie-accept"),a=document.getElementById("cookie-decline");e&&t&&a&&(localStorage.getItem("cookiesAccepted")||(e.style.display="block"),t.addEventListener("click",()=>{localStorage.setItem("cookiesAccepted","true"),e.style.display="none"}),a.addEventListener("click",()=>{localStorage.setItem("cookiesAccepted","false"),e.style.display="none"}))}setupGameIframe(){var e=document.getElementById("start-game-btn");let a=document.getElementById("game-overlay"),n=document.getElementById("game-iframe"),t=document.getElementById("game-wrapper");var o=document.getElementById("fullscreen-btn");let i=document.getElementById("fullscreen-btn-text");e&&a&&n&&e.addEventListener("click",async()=>{a.style.display="none",n.focus(),n.classList.add("game-active");try{var e;if((window.AudioContext||window.webkitAudioContext)&&("suspended"===(e=new(window.AudioContext||window.webkitAudioContext)).state&&await e.resume(),window.gameAudioContext=e),n.contentWindow&&n.contentWindow.AudioContext)try{var t=new n.contentWindow.AudioContext;"suspended"===t.state&&await t.resume(),n.audioContext=t}catch(e){}}catch(e){}}),o&&t&&i&&o.addEventListener("click",()=>{this.toggleFullscreen(t,i)}),document.addEventListener("fullscreenchange",()=>{document.fullscreenElement?i&&this.data.playGame&&(i.textContent=this.data.playGame.exitFullscreenButton):(t.classList.remove("fullscreen"),i&&this.data.playGame&&(i.textContent=this.data.playGame.fullscreenButton))}),n&&(n.addEventListener("load",()=>{n.classList.add("loaded");try{n.contentWindow&&(n.contentWindow.addEventListener("error",e=>{e.preventDefault()}),setTimeout(()=>{try{n.contentWindow&&n.contentWindow.YYGGames&&"object"==typeof n.contentWindow.YYGGames&&"function"==typeof n.contentWindow.YYGGames.init&&n.contentWindow.YYGGames.init()}catch(e){}},2e3))}catch(e){}}),n.addEventListener("error",()=>{}),n.addEventListener("securitypolicyviolation",e=>{e.preventDefault()})),this.setupKeyboardControls(n)}setupKeyboardControls(i){if(i){let a=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","KeyW","KeyA","KeyS","KeyD","Space","Enter","Escape","KeyZ","KeyX","KeyC"],n=()=>{try{i.contentWindow&&i.contentWindow.focus()}catch(e){}},o=(e,t)=>{try{i.contentWindow.postMessage({type:"keyboardEvent",eventType:e,key:t.key,code:t.code,keyCode:t.keyCode,which:t.which,shiftKey:t.shiftKey,ctrlKey:t.ctrlKey,altKey:t.altKey,metaKey:t.metaKey,timestamp:Date.now()},"*")}catch(e){}};i.addEventListener("click",n),document.addEventListener("keydown",e=>{var t;i.classList.contains("game-active")&&a.includes(e.code)&&((t=document.activeElement)&&("INPUT"===t.tagName||"TEXTAREA"===t.tagName||"SELECT"===t.tagName||"true"===t.contentEditable)||(e.preventDefault(),e.stopPropagation(),n(),o("keydown",e)))}),document.addEventListener("keyup",e=>{var t;i.classList.contains("game-active")&&a.includes(e.code)&&((t=document.activeElement)&&("INPUT"===t.tagName||"TEXTAREA"===t.tagName||"SELECT"===t.tagName||"true"===t.contentEditable)||(e.preventDefault(),e.stopPropagation(),o("keyup",e)))}),i.addEventListener("load",()=>{setTimeout(n,1e3)})}}toggleFullscreen(e,t){document.fullscreenElement?document.exitFullscreen().then(()=>{e.classList.remove("fullscreen"),t&&this.data.playGame&&(t.textContent=this.data.playGame.fullscreenButton)}).catch(e=>{}):e.requestFullscreen().then(()=>{e.classList.add("fullscreen"),t&&this.data.playGame&&(t.textContent=this.data.playGame.exitFullscreenButton)}).catch(e=>{})}setupNewsModals(){var e=document.getElementById("news-grid"),t=document.getElementById("news-modal"),a=document.getElementById("modal-overlay"),n=document.getElementById("modal-close");e&&t&&a&&n&&(a.addEventListener("click",()=>this.closeModal()),n.addEventListener("click",()=>this.closeModal()),document.addEventListener("keydown",e=>{"Escape"===e.key&&this.closeModal()}))}setupContactForm(){var e=document.getElementById("contact-form");e&&(e.addEventListener("submit",e=>{e.preventDefault(),this.handleContactForm(e.target)}),e.querySelectorAll("input, textarea").forEach(t=>{t.addEventListener("animationstart",e=>{"onAutoFillStart"===e.animationName&&t.classList.add("autofilled")}),t.addEventListener("input",()=>{t.value?t.classList.add("has-value"):t.classList.remove("has-value"),t.classList.remove("error","invalid","valid")}),t.addEventListener("focus",()=>{t.classList.add("focused")}),t.addEventListener("blur",()=>{t.classList.remove("focused")})}))}setupHeaderScroll(){let t=document.querySelector(".header"),a=window.scrollY;window.addEventListener("scroll",()=>{var e=window.scrollY;100<e?t.classList.add("scrolled"):t.classList.remove("scrolled"),e>a&&200<e?t.classList.add("hidden"):t.classList.remove("hidden"),a=e})}setupNavigationHighlighting(){let o=document.querySelectorAll(".nav__link"),e=document.querySelectorAll("section[id]");var t=()=>{let n=window.scrollY+100;e.forEach(e=>{var t=e.offsetTop,a=e.offsetHeight,e=e.getAttribute("id");n>=t&&n<t+a&&(o.forEach(e=>e.classList.remove("active")),t=document.querySelector(`.nav__link[href="#${e}"]`))&&t.classList.add("active")})};window.addEventListener("scroll",t),t()}renderContent(){this.data&&(this.updateMetaTags(),this.renderHeader(),this.renderHero(),this.renderGame(),this.renderHowToPlay(),this.renderReviews(),this.renderNews(),this.renderContact(),this.renderFooter(),this.renderCookieBar())}updateMetaTags(){var e;this.data.meta&&(document.title=this.data.meta.title,(e=document.querySelector('meta[name="description"]'))&&e.setAttribute("content",this.data.meta.description),e=document.querySelector('meta[name="keywords"]'))&&e.setAttribute("content",this.data.meta.keywords)}renderHeader(){if(this.data.header){var e=document.querySelector(".logo__text"),t=document.querySelector(".logo__accent"),e=(e&&this.data.header.logo&&(e.textContent=this.data.header.logo.text),t&&this.data.header.logo&&(t.textContent=this.data.header.logo.accent),document.querySelectorAll(".nav__link")),t=document.querySelectorAll(".mobile-menu__link");if(this.data.header.navigation){let n=this.data.header.navigation;e.forEach((e,t)=>{var a=Object.keys(n);a[t]&&(e.textContent=n[a[t]])}),t.forEach((e,t)=>{var a=Object.keys(n);a[t]&&(e.textContent=n[a[t]])})}}}renderHero(){var e,t,a,n,o;this.data.hero&&(e=document.querySelector(".hero__badge-text"),t=document.getElementById("hero-title"),a=document.getElementById("hero-description"),n=document.getElementById("play-now-btn"),o=document.getElementById("watch-trailer-btn"),e&&(e.textContent=this.data.hero.badge),t&&(t.textContent=this.data.hero.title),a&&(a.textContent=this.data.hero.description),n&&this.data.hero.actions&&(n.querySelector(".btn__text").textContent=this.data.hero.actions.playNow),o&&this.data.hero.actions&&(o.querySelector(".btn__text").textContent=this.data.hero.actions.howToPlay),this.renderHeroFeatures(),this.renderGamePreview())}renderHeroFeatures(){var e;this.data.hero?.features&&(e=document.querySelector(".hero__features"))&&(e.innerHTML=this.data.hero.features.map(e=>`
        <div class="hero__feature">
          <span class="hero__feature-icon">
            <svg class="icon icon--${e.icon}" aria-hidden="true">
              <use href="#${e.icon}"></use>
            </svg>
          </span>
          <span class="hero__feature-text">${e.text}</span>
        </div>
      `).join(""))}renderGamePreview(){var e,t,a,n,o,i,r;this.data.hero?.gamePreview&&((e=document.querySelector(".game-preview__title"))&&(e.textContent=this.data.hero.gamePreview.title),this.data.hero.gamePreview.stats)&&(e=this.data.hero.gamePreview.stats,t=document.querySelector(".game-preview__stat:nth-child(1) .stat__value"),a=document.querySelector(".game-preview__stat:nth-child(1) .stat__label"),n=document.querySelector(".game-preview__stat:nth-child(2) .stat__value"),o=document.querySelector(".game-preview__stat:nth-child(2) .stat__label"),i=document.querySelector(".game-preview__stat:nth-child(3) .stat__value"),r=document.querySelector(".game-preview__stat:nth-child(3) .stat__label"),t&&e.rating&&(t.textContent=e.rating.value),a&&e.rating&&(a.textContent=e.rating.label),n&&e.players&&(n.textContent=e.players.value),o&&e.players&&(o.textContent=e.players.label),i&&e.songs&&(i.textContent=e.songs.value),r)&&e.songs&&(r.textContent=e.songs.label)}renderGame(){var e,t,a,n,o;this.data.game&&(e=document.querySelector(".game__title"),t=document.querySelector(".game__description"),a=document.getElementById("start-game-btn"),n=document.getElementById("game-iframe"),o=document.getElementById("fullscreen-btn-text"),e&&(e.textContent=this.data.game.title),t&&(t.textContent=this.data.game.description),a&&(a.textContent=this.data.game.startButton),o&&this.data.playGame&&(o.textContent=this.data.playGame.fullscreenButton),n)&&this.data.playGame?.iframe&&(n.src=this.data.playGame.iframe.src)}renderHowToPlay(){var e,t,a;this.data.howToPlay&&(e=document.getElementById("how-to-play-title"),t=document.querySelector(".how-to-play .section-description"),a=document.getElementById("steps-container"),e&&(e.textContent=this.data.howToPlay.title),t&&(t.textContent=this.data.howToPlay.description),a)&&this.data.howToPlay.steps&&(a.innerHTML=this.data.howToPlay.steps.map(e=>`
          <div class="step-card">
            <div class="step-card__number">${e.step}</div>
            <div class="step-card__content">
              <h3 class="step-card__title">${e.title}</h3>
              <p class="step-card__description">${e.description}</p>
            </div>
          </div>
        `).join(""))}renderReviews(){var e,t,a;this.data.reviews&&(e=document.getElementById("reviews-title"),t=document.querySelector(".reviews .section-description"),a=document.getElementById("reviews-grid"),e&&(e.textContent=this.data.reviews.title),t&&(t.textContent=this.data.reviews.description),a)&&this.data.reviews.reviews&&(a.innerHTML=this.data.reviews.reviews.map(e=>`
          <div class="review-card">
            <div class="review-card__header">
              <img src="${e.avatar}" alt="${e.player}" class="review-card__avatar" />
              <div class="review-card__info">
                <h4 class="review-card__player">${e.player}</h4>
                <div class="review-card__rating">
                  ${"★".repeat(e.rating)}${"☆".repeat(5-e.rating)}
                </div>
              </div>
            </div>
            <p class="review-card__comment">${e.comment}</p>
          </div>
        `).join(""))}renderNews(){var e,t,a;this.data.news&&(e=document.getElementById("news-title"),t=document.querySelector(".news .section-description"),a=document.getElementById("news-grid"),e&&(e.textContent=this.data.news.title),t&&(t.textContent=this.data.news.description),a)&&this.data.news.articles&&(a.innerHTML=this.data.news.articles.map(e=>`
          <div class="news-card" data-article-id="${e.id}">
            <div class="news-card__image">
              <img src="${e.image}" alt="${e.title}" />
            </div>
            <div class="news-card__content">
              <h3 class="news-card__title">${e.title}</h3>
              <p class="news-card__excerpt">${e.excerpt}</p>
              <div class="news-card__meta">
                <span class="news-card__date">${new Date(e.date).toLocaleDateString("uk-UA")}</span>
                <button class="btn btn--ghost news-card__read-more">Читати далі</button>
              </div>
            </div>
          </div>
        `).join(""),document.querySelectorAll(".news-card").forEach(t=>{t.addEventListener("click",()=>{var e=t.dataset.articleId;this.openNewsModal(e)})}))}renderContact(){var e,t,a;this.data.contact&&(a=document.getElementById("contact-title"),e=document.querySelector(".contact .section-description"),t=document.getElementById("contact-email"),a&&(a.textContent=this.data.contact.title),e&&(e.textContent=this.data.contact.description),t&&this.data.contact.info&&(t.href="mailto:"+this.data.contact.info.email,t.textContent=this.data.contact.info.email),(a=document.getElementById("contact-address"))&&this.data.contact.info?.address&&(a.textContent=this.data.contact.info.address),this.updateContactForm())}updateContactForm(){var e,t,a;this.data.contact?.form&&(e=this.data.contact.form,a=document.querySelector('label[for="contact-name"]'),t=document.getElementById("contact-name"),a&&(a.textContent=e.name.label),t&&(t.placeholder=e.name.placeholder),a=document.querySelector('label[for="contact-email-input"]'),t=document.getElementById("contact-email-input"),a&&(a.textContent=e.email.label),t&&(t.placeholder=e.email.placeholder),a=document.querySelector('label[for="contact-message"]'),t=document.getElementById("contact-message"),a&&(a.textContent=e.message.label),t&&(t.placeholder=e.message.placeholder),a=document.querySelector(".contact-form .btn--primary .btn__text"))&&(a.textContent=e.submit)}renderFooter(){var e,t;this.data.footer&&(e=document.querySelector(".footer__logo .logo__text"),t=document.querySelector(".footer__logo .logo__accent"),e&&this.data.footer.brand&&(e.textContent=this.data.footer.brand.text),t&&this.data.footer.brand&&(t.textContent=this.data.footer.brand.accent),(e=document.querySelector(".footer__description"))&&(e.textContent=this.data.footer.description),this.updateFooterSections(),t=document.getElementById("footer-copyright"))&&(t.textContent=this.data.footer.copyright)}updateFooterSections(){if(this.data.footer?.sections){var e=this.data.footer.sections;if(e.game){var t=document.querySelector(".footer__section:nth-child(1) .footer__title");t&&(t.textContent=e.game.title);let a=document.querySelectorAll(".footer__section:nth-child(1) .footer__link");e.game.links.forEach((e,t)=>{a[t]&&(a[t].textContent=e.text,a[t].href=e.href)})}if(e.community){t=document.querySelector(".footer__section:nth-child(2) .footer__title");t&&(t.textContent=e.community.title);let a=document.querySelectorAll(".footer__section:nth-child(2) .footer__link");e.community.links.forEach((e,t)=>{a[t]&&(a[t].textContent=e.text,a[t].href=e.href,e.external)&&(a[t].target="_blank",a[t].rel="noopener")})}if(e.legal){t=document.querySelector(".footer__section:nth-child(3) .footer__title");t&&(t.textContent=e.legal.title);let a=document.querySelectorAll(".footer__section:nth-child(3) .footer__link");e.legal.links.forEach((e,t)=>{a[t]&&(a[t].textContent=e.text,a[t].href=e.href)})}}}renderCookieBar(){var e,t,a;this.data.cookieBar&&(e=document.getElementById("cookie-message"),t=document.getElementById("cookie-accept"),a=document.getElementById("cookie-decline"),e&&(e.textContent=this.data.cookieBar.message),t&&(t.textContent=this.data.cookieBar.accept),a)&&(a.textContent=this.data.cookieBar.decline)}openNewsModal(t){var e,a,n,o,i,r=this.data.news.articles.find(e=>e.id==t);r&&(e=document.getElementById("news-modal"),a=document.getElementById("modal-title"),n=document.getElementById("modal-image"),o=document.getElementById("modal-date"),i=document.getElementById("modal-body"),e)&&a&&n&&o&&i&&(a.textContent=r.title,n.src=r.image,n.alt=r.title,o.textContent=new Date(r.date).toLocaleDateString("uk-UA"),i.textContent=r.content,e.classList.add("active"),document.body.classList.add("modal-open"))}closeModal(){var e=document.getElementById("news-modal");e&&(e.classList.remove("active"),document.body.classList.remove("modal-open"))}async handleContactForm(e){var t=new FormData(e),t=Object.fromEntries(t),a=(console.log("📝 Дані форми:",t),this.clearValidationStates(e),[]),n=e.querySelector("#contact-name"),o=e.querySelector("#contact-email-input"),i=e.querySelector("#contact-message");if(!t.name||t.name.trim().length<2?(a.push("Ім'я повинно містити мінімум 2 символи"),n&&(n.classList.add("error"),n.classList.remove("valid"))):n&&(n.classList.add("valid"),n.classList.remove("error")),t.email&&t.email.includes("@")?o&&(o.classList.add("valid"),o.classList.remove("error")):(a.push("Введіть коректний email"),o&&(o.classList.add("error"),o.classList.remove("valid"))),!t.message||t.message.trim().length<10?(a.push("Повідомлення повинно містити мінімум 10 символів"),i&&(i.classList.add("error"),i.classList.remove("valid"))):i&&(i.classList.add("valid"),i.classList.remove("error")),0<a.length)alert("Помилки валідації:\n"+a.join("\n"));else{n=e.querySelector(".form__submit"),o=n.innerHTML;n.innerHTML=`<span class="btn__text">${this.data.contact.form.sending}</span><span class="btn__icon">📤</span>`,n.disabled=!0;try{await new Promise(e=>setTimeout(e,2e3)),alert(this.data.contact.form.success),e.reset()}catch(e){alert(this.data.contact.form.error)}finally{n.innerHTML=o,n.disabled=!1}}}clearValidationStates(e){e.querySelectorAll("input, textarea").forEach(e=>{e.classList.remove("error","invalid","valid")})}openMobileMenu(e,t){try{var a=window.scrollY;e.classList.add("active"),t.classList.add("active"),document.body.classList.add("menu-open"),document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.top=`-${a}px`,document.body.style.width="100%",document.body.dataset.scrollY=a}catch(e){}}closeMobileMenu(e,t){try{e.classList.remove("active"),t.classList.remove("active"),document.body.classList.remove("menu-open");var a=document.body.dataset.scrollY;document.body.style.overflow="",document.body.style.position="",document.body.style.top="",document.body.style.width="",a&&(window.scrollTo(0,parseInt(a)),delete document.body.dataset.scrollY)}catch(e){}}loadDataWithXHR(){return new Promise((t,a)=>{let n=new XMLHttpRequest;n.open("GET","data.json",!0),n.timeout=5e3,n.onload=function(){if(200===n.status)try{var e=JSON.parse(n.responseText);t(e)}catch(e){a(new Error("Failed to parse JSON: "+e.message))}else a(new Error("XHR failed with status: "+n.status))},n.onerror=function(){a(new Error("XHR request failed"))},n.ontimeout=function(){a(new Error("XHR request timed out"))},n.send()})}initializeComponents(){this.loadExternalScriptsSafely()}loadExternalScriptsSafely(){window.EnvironmentHelpers?.isServiceEnabled("GAMEMONETIZE")&&[{id:"gamemonetize-sdk",src:window.Environment?.EXTERNAL_SERVICES?.GAMEMONETIZE?.SDK_URL||"https://html5.gamemonetize.co/sdk.js",async:!0,fallback:()=>{window.EnvironmentHelpers?.isDevelopment()&&console.warn("Gamemonetize SDK failed to load - continuing without ads")}}].forEach(t=>{try{var e=document.createElement("script");e.id=t.id,e.src=t.src,e.async=t.async||!1,e.onerror=()=>{t.fallback&&t.fallback()},e.onload=()=>{window.EnvironmentHelpers?.isDevelopment()&&console.log(t.id+" loaded successfully")},document.head.appendChild(e)}catch(e){t.fallback&&t.fallback()}})}initializeYYGGames(){if(window.EnvironmentHelpers?.isServiceEnabled("YYGGAMES")){let e=window.Environment?.EXTERNAL_SERVICES?.YYGGAMES?.MAX_ATTEMPTS||10;window.Environment?.EXTERNAL_SERVICES?.YYGGAMES?.INIT_TIMEOUT;let t=0,a=()=>{try{if(window.YYGGames&&"function"==typeof window.YYGGames.init)return window.YYGGames.init(),void(window.EnvironmentHelpers?.isDevelopment()&&console.log("YYGGames SDK initialized successfully"))}catch(e){}++t<e?setTimeout(a,500):window.EnvironmentHelpers?.isDevelopment()&&console.warn("YYGGames SDK not available - continuing without game monetization")};setTimeout(a,1e3)}}}