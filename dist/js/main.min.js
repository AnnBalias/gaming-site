document.addEventListener("DOMContentLoaded",()=>{new FridayNightFunkin});class FridayNightFunkin{constructor(){this.data=null,this.init()}async init(){try{this.setupGlobalErrorHandlers(),await this.loadData(),this.setupEventListeners(),this.renderContent(),this.initializeComponents()}catch(e){}}setupGlobalErrorHandlers(){window.addEventListener("unhandledrejection",e=>{!e.reason||"string"!=typeof e.reason||e.reason.includes("gamemonetize")||e.reason.includes("YYGGames")||e.reason.includes("cocos2d")||e.reason.includes("about:blank"),e.preventDefault()}),window.addEventListener("error",e=>e.filename&&(e.filename.includes("gamemonetize")||e.filename.includes("YYGGames")||e.filename.includes("cocos2d")||e.filename.includes("sdk.js")||e.filename.includes("index.js")||e.filename.includes("about:blank"))||e.message&&e.message.includes("YYGGames")?(e.preventDefault(),!1):void 0)}async loadData(){try{var a,o=null;let t=!1;for(a of["data.json","./data.json","/data.json","../data.json"])try{let e=new AbortController;var n=setTimeout(()=>e.abort(),5e3),o=await fetch(a,{signal:e.signal});if(clearTimeout(n),o.ok){this.data=await o.json(),t=!0;break}}catch(e){continue}if(!t)try{this.data=await this.loadDataWithXHR()}catch(e){throw new Error("Failed to load data from all methods")}}catch(e){this.data={meta:{title:"CyberStrike Arena - Ритмічна музична битва",description:"Пориньте у божевільні ритми та надзвичайні дуелі.",keywords:"cyberstrike arena, ритм гра, музична гра, танцювальна гра, битва, музика"},header:{logo:{text:"CyberStrike",accent:"Arena"},navigation:{home:"Головна",game:"Грати зараз",howToPlay:"Як грати",news:"Новини",contact:"Контакти"}},hero:{badge:"🎮 Нова гра",title:"CyberStrike Arena",description:"Пориньте у божевільні ритми та надзвичайні дуелі.",actions:{playNow:"Грати зараз",howToPlay:"Як грати"},features:[{icon:"🎵",text:"Ритмічна музика"},{icon:"⚡",text:"Швидкі дуелі"},{icon:"🏆",text:"Турніри"}],gamePreview:{title:"Попередній перегляд",stats:{rating:{value:"4.8",label:"Рейтинг"},players:{value:"10K+",label:"Гравців"},songs:{value:"50+",label:"Пісень"}}}},game:{title:"Грати зараз",description:"Натисніть кнопку, щоб почати гру",startButton:"Почати гру"},playGame:{fullscreenButton:"Повноекранний режим",exitFullscreenButton:"Згорнути",iframe:{src:"https://html5.gamemonetize.co/8g62o78s1wjhsiu54xlmql32h7pagsek/",width:"720",height:"1280"}},howToPlay:{title:"Як грати",description:"Ознайомтеся з правилами гри",steps:[{step:"1",title:"Вибирайте пісню",description:"Оберіть улюблену пісню з колекції"},{step:"2",title:"Натискайте стрілки",description:"Натискайте стрілки в такт з битами"},{step:"3",title:"Залишайтесь в ритмі",description:"Тримайте ритм, щоб набрати бали"}]},reviews:{title:"Відгуки гравців",description:"Що говорять про нас гравці",reviews:[{player:"Анна",rating:5,comment:"Чудова гра! Дуже захоплююча музика.",avatar:"assets/images/avatar1.jpg"},{player:"Максим",rating:4,comment:"Гарний геймплей, але можна більше пісень.",avatar:"assets/images/avatar2.jpg"}]},news:{title:"Останні новини",description:"Будьте в курсі останніх подій та анонсів",articles:[{id:1,title:"Нова пісня додана",excerpt:"Додано нову захоплюючу пісню до колекції",content:"Ми раді повідомити, що до колекції додано нову захоплюючу пісню. Спробуйте її прямо зараз!",image:"assets/images/post.jpg",date:"2025-01-15"},{id:2,title:"Оновлення інтерфейсу",excerpt:"Покращений користувацький інтерфейс",content:"Ми оновили інтерфейс гри для кращого досвіду користувача. Тепер все виглядає ще краще!",image:"assets/images/post2.jpg",date:"2025-01-10"}]},contact:{title:"Зв'яжіться з нами",description:"Маєте питання? Напишіть нам!",info:{email:"support@cyberstrikearena.com",address:"м. Київ, вул. Вигадана, 123"},form:{name:{label:"Ім'я",placeholder:"Введіть ваше ім'я"},email:{label:"Email",placeholder:"Введіть ваш email"},message:{label:"Повідомлення",placeholder:"Введіть ваше повідомлення"},submit:"Надіслати",sending:"Надсилання...",success:"Повідомлення успішно надіслано!",error:"Помилка при надсиланні повідомлення."}},footer:{brand:{text:"CyberStrike",accent:"Arena"},description:"Найкраща ритмічна музична гра для всіх вікових груп.",sections:{game:{title:"Гра",links:[{text:"Грати зараз",href:"#game"},{text:"Як грати",href:"#how-to-play"},{text:"Правила",href:"#rules"}]},community:{title:"Спільнота",links:[{text:"Discord",href:"#",external:!0},{text:"Telegram",href:"#",external:!0},{text:"Форум",href:"#",external:!0}]},legal:{title:"Правові питання",links:[{text:"Умови використання",href:"terms.html"},{text:"Політика конфіденційності",href:"privacy.html"},{text:"Файли cookie",href:"cookies.html"}]}},copyright:"© 2025 CyberStrike Arena. Всі права захищені."},cookieBar:{message:"Ми використовуємо файли cookie для покращення вашого досвіду.",accept:"Прийняти",decline:"Відхилити"}}}}setupEventListeners(){let t=document.querySelector(".header__mobile-toggle"),a=document.querySelector(".mobile-menu");var e=document.querySelector(".mobile-menu__close"),o=document.querySelector(".mobile-menu__overlay"),e=(t&&a&&(t.addEventListener("click",()=>{this.openMobileMenu(t,a)}),e&&e.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),this.closeMobileMenu(t,a)}),o&&o.addEventListener("click",()=>{this.closeMobileMenu(t,a)}),document.querySelectorAll(".mobile-menu__link").forEach(e=>{e.addEventListener("click",()=>{this.closeMobileMenu(t,a)})}),document.addEventListener("keydown",e=>{"Escape"===e.key&&a.classList.contains("active")&&this.closeMobileMenu(t,a)})),document.querySelectorAll('a[href^="#"]')),o=document.querySelectorAll("#play-now-btn, #watch-trailer-btn");let n=t=>{try{var e,a,o,n=document.querySelector(t);n&&(a=(e=document.querySelector(".header"))?e.offsetHeight:0,o=n.offsetTop-a,window.scrollTo({top:o,behavior:"smooth"}))}catch(e){try{var r=document.querySelector(t);r&&r.scrollIntoView()}catch(e){}}};e.forEach(t=>{t.addEventListener("click",e=>{e.preventDefault(),n(t.getAttribute("href"))})}),o.forEach(t=>{t.addEventListener("click",e=>{e.preventDefault(),"play-now-btn"===t.id?n("#game"):"watch-trailer-btn"===t.id&&n("#how-to-play")})}),this.setupCookieBar(),this.setupGameIframe(),this.setupNewsModals(),this.setupContactForm(),this.setupHeaderScroll(),this.setupNavigationHighlighting()}setupCookieBar(){let e=document.getElementById("cookie-bar");var t=document.getElementById("cookie-accept"),a=document.getElementById("cookie-decline");e&&t&&a&&(localStorage.getItem("cookiesAccepted")||(e.style.display="block"),t.addEventListener("click",()=>{localStorage.setItem("cookiesAccepted","true"),e.style.display="none"}),a.addEventListener("click",()=>{localStorage.setItem("cookiesAccepted","false"),e.style.display="none"}))}setupGameIframe(){var e=document.getElementById("start-game-btn");let a=document.getElementById("game-overlay"),o=document.getElementById("game-iframe"),t=document.getElementById("game-wrapper");var n=document.getElementById("fullscreen-btn");let r=document.getElementById("fullscreen-btn-text");e&&a&&o&&e.addEventListener("click",async()=>{a.style.display="none",o.focus(),o.classList.add("game-active");try{var e;if((window.AudioContext||window.webkitAudioContext)&&("suspended"===(e=new(window.AudioContext||window.webkitAudioContext)).state&&await e.resume(),window.gameAudioContext=e),o.contentWindow&&o.contentWindow.AudioContext)try{var t=new o.contentWindow.AudioContext;"suspended"===t.state&&await t.resume(),o.audioContext=t}catch(e){}}catch(e){}}),n&&t&&r&&n.addEventListener("click",()=>{this.toggleFullscreen(t,r)}),document.addEventListener("fullscreenchange",()=>{document.fullscreenElement?r&&this.data.playGame&&(r.textContent=this.data.playGame.exitFullscreenButton):(t.classList.remove("fullscreen"),r&&this.data.playGame&&(r.textContent=this.data.playGame.fullscreenButton))}),o&&(o.addEventListener("load",()=>{o.classList.add("loaded");try{if(o.contentWindow){o.contentWindow.addEventListener("error",e=>{e.preventDefault()});try{o.contentWindow&&o.contentWindow.YYGGames&&"object"==typeof o.contentWindow.YYGGames&&"function"==typeof o.contentWindow.YYGGames.init&&o.contentWindow.YYGGames.init()}catch(e){}}}catch(e){}}),o.addEventListener("error",()=>{})),this.setupKeyboardControls(o)}setupKeyboardControls(n){if(n){let t=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","KeyW","KeyA","KeyS","KeyD","Space","Enter","Escape","KeyZ","KeyX","KeyC"],a=()=>{try{n.contentWindow&&n.contentWindow.focus()}catch(e){}},o=(e,t)=>{try{n.contentWindow.postMessage({type:"keyboardEvent",eventType:e,key:t.key,code:t.code,keyCode:t.keyCode,which:t.which,shiftKey:t.shiftKey,ctrlKey:t.ctrlKey,altKey:t.altKey,metaKey:t.metaKey,timestamp:Date.now()},"*")}catch(e){}};n.addEventListener("click",a),document.addEventListener("keydown",e=>{n.classList.contains("game-active")&&t.includes(e.code)&&(e.preventDefault(),e.stopPropagation(),a(),o("keydown",e))}),document.addEventListener("keyup",e=>{n.classList.contains("game-active")&&t.includes(e.code)&&(e.preventDefault(),e.stopPropagation(),o("keyup",e))}),n.addEventListener("load",()=>{setTimeout(a,1e3)})}}toggleFullscreen(e,t){document.fullscreenElement?document.exitFullscreen().then(()=>{e.classList.remove("fullscreen"),t&&this.data.playGame&&(t.textContent=this.data.playGame.fullscreenButton)}).catch(e=>{}):e.requestFullscreen().then(()=>{e.classList.add("fullscreen"),t&&this.data.playGame&&(t.textContent=this.data.playGame.exitFullscreenButton)}).catch(e=>{})}setupNewsModals(){var e=document.getElementById("news-grid"),t=document.getElementById("news-modal"),a=document.getElementById("modal-overlay"),o=document.getElementById("modal-close");e&&t&&a&&o&&(a.addEventListener("click",()=>this.closeModal()),o.addEventListener("click",()=>this.closeModal()),document.addEventListener("keydown",e=>{"Escape"===e.key&&this.closeModal()}))}setupContactForm(){var e=document.getElementById("contact-form");e&&e.addEventListener("submit",e=>{e.preventDefault(),this.handleContactForm(e.target)})}setupHeaderScroll(){let t=document.querySelector(".header"),a=window.scrollY;window.addEventListener("scroll",()=>{var e=window.scrollY;100<e?t.classList.add("scrolled"):t.classList.remove("scrolled"),e>a&&200<e?t.classList.add("hidden"):t.classList.remove("hidden"),a=e})}setupNavigationHighlighting(){let n=document.querySelectorAll(".nav__link"),e=document.querySelectorAll("section[id]");var t=()=>{let o=window.scrollY+100;e.forEach(e=>{var t=e.offsetTop,a=e.offsetHeight,e=e.getAttribute("id");o>=t&&o<t+a&&(n.forEach(e=>e.classList.remove("active")),t=document.querySelector(`.nav__link[href="#${e}"]`))&&t.classList.add("active")})};window.addEventListener("scroll",t),t()}renderContent(){this.data&&(this.updateMetaTags(),this.renderHeader(),this.renderHero(),this.renderGame(),this.renderHowToPlay(),this.renderReviews(),this.renderNews(),this.renderContact(),this.renderFooter(),this.renderCookieBar())}updateMetaTags(){var e;this.data.meta&&(document.title=this.data.meta.title,(e=document.querySelector('meta[name="description"]'))&&e.setAttribute("content",this.data.meta.description),e=document.querySelector('meta[name="keywords"]'))&&e.setAttribute("content",this.data.meta.keywords)}renderHeader(){if(this.data.header){var e=document.querySelector(".logo__text"),t=document.querySelector(".logo__accent"),e=(e&&this.data.header.logo&&(e.textContent=this.data.header.logo.text),t&&this.data.header.logo&&(t.textContent=this.data.header.logo.accent),document.querySelectorAll(".nav__link")),t=document.querySelectorAll(".mobile-menu__link");if(this.data.header.navigation){let o=this.data.header.navigation;e.forEach((e,t)=>{var a=Object.keys(o);a[t]&&(e.textContent=o[a[t]])}),t.forEach((e,t)=>{var a=Object.keys(o);a[t]&&(e.textContent=o[a[t]])})}}}renderHero(){var e,t,a,o,n;this.data.hero&&(e=document.querySelector(".hero__badge-text"),t=document.getElementById("hero-title"),a=document.getElementById("hero-description"),o=document.getElementById("play-now-btn"),n=document.getElementById("watch-trailer-btn"),e&&(e.textContent=this.data.hero.badge),t&&(t.textContent=this.data.hero.title),a&&(a.textContent=this.data.hero.description),o&&this.data.hero.actions&&(o.querySelector(".btn__text").textContent=this.data.hero.actions.playNow),n&&this.data.hero.actions&&(n.querySelector(".btn__text").textContent=this.data.hero.actions.howToPlay),this.renderHeroFeatures(),this.renderGamePreview())}renderHeroFeatures(){var e;this.data.hero?.features&&(e=document.querySelector(".hero__features"))&&(e.innerHTML=this.data.hero.features.map(e=>`
        <div class="hero__feature">
          <span class="hero__feature-icon">${e.icon}</span>
          <span class="hero__feature-text">${e.text}</span>
        </div>
      `).join(""))}renderGamePreview(){var e,t,a,o,n,r,i;this.data.hero?.gamePreview&&((e=document.querySelector(".game-preview__title"))&&(e.textContent=this.data.hero.gamePreview.title),this.data.hero.gamePreview.stats)&&(e=this.data.hero.gamePreview.stats,t=document.querySelector(".game-preview__stat:nth-child(1) .stat__value"),a=document.querySelector(".game-preview__stat:nth-child(1) .stat__label"),o=document.querySelector(".game-preview__stat:nth-child(2) .stat__value"),n=document.querySelector(".game-preview__stat:nth-child(2) .stat__label"),r=document.querySelector(".game-preview__stat:nth-child(3) .stat__value"),i=document.querySelector(".game-preview__stat:nth-child(3) .stat__label"),t&&e.rating&&(t.textContent=e.rating.value),a&&e.rating&&(a.textContent=e.rating.label),o&&e.players&&(o.textContent=e.players.value),n&&e.players&&(n.textContent=e.players.label),r&&e.songs&&(r.textContent=e.songs.value),i)&&e.songs&&(i.textContent=e.songs.label)}renderGame(){var e,t,a,o,n;this.data.game&&(e=document.querySelector(".game__title"),t=document.querySelector(".game__description"),a=document.getElementById("start-game-btn"),o=document.getElementById("game-iframe"),n=document.getElementById("fullscreen-btn-text"),e&&(e.textContent=this.data.game.title),t&&(t.textContent=this.data.game.description),a&&(a.textContent=this.data.game.startButton),n&&this.data.playGame&&(n.textContent=this.data.playGame.fullscreenButton),o)&&this.data.playGame?.iframe&&(o.src=this.data.playGame.iframe.src)}renderHowToPlay(){var e,t,a;this.data.howToPlay&&(e=document.getElementById("how-to-play-title"),t=document.querySelector(".how-to-play .section-description"),a=document.getElementById("steps-container"),e&&(e.textContent=this.data.howToPlay.title),t&&(t.textContent=this.data.howToPlay.description),a)&&this.data.howToPlay.steps&&(a.innerHTML=this.data.howToPlay.steps.map(e=>`
          <div class="step-card">
            <div class="step-card__number">${e.step}</div>
            <div class="step-card__content">
              <h3 class="step-card__title">${e.title}</h3>
              <p class="step-card__description">${e.description}</p>
            </div>
          </div>
        `).join(""))}renderReviews(){var e,t,a;this.data.reviews&&(e=document.getElementById("reviews-title"),t=document.querySelector(".reviews .section-description"),a=document.getElementById("reviews-grid"),e&&(e.textContent=this.data.reviews.title),t&&(t.textContent=this.data.reviews.description),a)&&this.data.reviews.reviews&&(a.innerHTML=this.data.reviews.reviews.map(e=>`
          <div class="review-card">
            <div class="review-card__header">
              <img src="${e.avatar}" alt="${e.player}" class="review-card__avatar" />
              <div class="review-card__info">
                <h4 class="review-card__player">${e.player}</h4>
                <div class="review-card__rating">
                  ${"★".repeat(e.rating)}${"☆".repeat(5-e.rating)}
                </div>
              </div>
            </div>
            <p class="review-card__comment">${e.comment}</p>
          </div>
        `).join(""))}renderNews(){var e,t,a;this.data.news&&(e=document.getElementById("news-title"),t=document.querySelector(".news .section-description"),a=document.getElementById("news-grid"),e&&(e.textContent=this.data.news.title),t&&(t.textContent=this.data.news.description),a)&&this.data.news.articles&&(a.innerHTML=this.data.news.articles.map(e=>`
          <div class="news-card" data-article-id="${e.id}">
            <div class="news-card__image">
              <img src="${e.image}" alt="${e.title}" />
            </div>
            <div class="news-card__content">
              <h3 class="news-card__title">${e.title}</h3>
              <p class="news-card__excerpt">${e.excerpt}</p>
              <div class="news-card__meta">
                <span class="news-card__date">${new Date(e.date).toLocaleDateString("uk-UA")}</span>
                <button class="btn btn--ghost news-card__read-more">Читати далі</button>
              </div>
            </div>
          </div>
        `).join(""),document.querySelectorAll(".news-card").forEach(t=>{t.addEventListener("click",()=>{var e=t.dataset.articleId;this.openNewsModal(e)})}))}renderContact(){var e,t,a;this.data.contact&&(a=document.getElementById("contact-title"),e=document.querySelector(".contact .section-description"),t=document.getElementById("contact-email"),a&&(a.textContent=this.data.contact.title),e&&(e.textContent=this.data.contact.description),t&&this.data.contact.info&&(t.href="mailto:"+this.data.contact.info.email,t.textContent=this.data.contact.info.email),(a=document.getElementById("contact-address"))&&this.data.contact.info?.address&&(a.textContent=this.data.contact.info.address),this.updateContactForm())}updateContactForm(){var e,t,a;this.data.contact?.form&&(e=this.data.contact.form,a=document.querySelector('label[for="contact-name"]'),t=document.getElementById("contact-name"),a&&(a.textContent=e.name.label),t&&(t.placeholder=e.name.placeholder),a=document.querySelector('label[for="contact-email-input"]'),t=document.getElementById("contact-email-input"),a&&(a.textContent=e.email.label),t&&(t.placeholder=e.email.placeholder),a=document.querySelector('label[for="contact-message"]'),t=document.getElementById("contact-message"),a&&(a.textContent=e.message.label),t&&(t.placeholder=e.message.placeholder),a=document.querySelector(".contact-form .btn--primary .btn__text"))&&(a.textContent=e.submit)}renderFooter(){var e,t;this.data.footer&&(e=document.querySelector(".footer__logo .logo__text"),t=document.querySelector(".footer__logo .logo__accent"),e&&this.data.footer.brand&&(e.textContent=this.data.footer.brand.text),t&&this.data.footer.brand&&(t.textContent=this.data.footer.brand.accent),(e=document.querySelector(".footer__description"))&&(e.textContent=this.data.footer.description),this.updateFooterSections(),t=document.getElementById("footer-copyright"))&&(t.textContent=this.data.footer.copyright)}updateFooterSections(){if(this.data.footer?.sections){var e=this.data.footer.sections;if(e.game){var t=document.querySelector(".footer__section:nth-child(1) .footer__title");t&&(t.textContent=e.game.title);let a=document.querySelectorAll(".footer__section:nth-child(1) .footer__link");e.game.links.forEach((e,t)=>{a[t]&&(a[t].textContent=e.text,a[t].href=e.href)})}if(e.community){t=document.querySelector(".footer__section:nth-child(2) .footer__title");t&&(t.textContent=e.community.title);let a=document.querySelectorAll(".footer__section:nth-child(2) .footer__link");e.community.links.forEach((e,t)=>{a[t]&&(a[t].textContent=e.text,a[t].href=e.href,e.external)&&(a[t].target="_blank",a[t].rel="noopener")})}if(e.legal){t=document.querySelector(".footer__section:nth-child(3) .footer__title");t&&(t.textContent=e.legal.title);let a=document.querySelectorAll(".footer__section:nth-child(3) .footer__link");e.legal.links.forEach((e,t)=>{a[t]&&(a[t].textContent=e.text,a[t].href=e.href)})}}}renderCookieBar(){var e,t,a;this.data.cookieBar&&(e=document.getElementById("cookie-message"),t=document.getElementById("cookie-accept"),a=document.getElementById("cookie-decline"),e&&(e.textContent=this.data.cookieBar.message),t&&(t.textContent=this.data.cookieBar.accept),a)&&(a.textContent=this.data.cookieBar.decline)}openNewsModal(t){var e,a,o,n,r,i=this.data.news.articles.find(e=>e.id==t);i&&(e=document.getElementById("news-modal"),a=document.getElementById("modal-title"),o=document.getElementById("modal-image"),n=document.getElementById("modal-date"),r=document.getElementById("modal-body"),e)&&a&&o&&n&&r&&(a.textContent=i.title,o.src=i.image,o.alt=i.title,n.textContent=new Date(i.date).toLocaleDateString("uk-UA"),r.textContent=i.content,e.classList.add("active"),document.body.classList.add("modal-open"))}closeModal(){var e=document.getElementById("news-modal");e&&(e.classList.remove("active"),document.body.classList.remove("modal-open"))}async handleContactForm(e){var t=new FormData(e),t=(Object.fromEntries(t),e.querySelector(".form__submit")),a=t.innerHTML;t.innerHTML=`<span class="btn__text">${this.data.contact.form.sending}</span><span class="btn__icon">📤</span>`,t.disabled=!0;try{await new Promise(e=>setTimeout(e,2e3)),alert(this.data.contact.form.success),e.reset()}catch(e){alert(this.data.contact.form.error)}finally{t.innerHTML=a,t.disabled=!1}}openMobileMenu(e,t){try{var a=window.scrollY;e.classList.add("active"),t.classList.add("active"),document.body.classList.add("menu-open"),document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.top=`-${a}px`,document.body.style.width="100%",document.body.dataset.scrollY=a}catch(e){}}closeMobileMenu(e,t){try{e.classList.remove("active"),t.classList.remove("active"),document.body.classList.remove("menu-open");var a=document.body.dataset.scrollY;document.body.style.overflow="",document.body.style.position="",document.body.style.top="",document.body.style.width="",a&&(window.scrollTo(0,parseInt(a)),delete document.body.dataset.scrollY)}catch(e){}}loadDataWithXHR(){return new Promise((t,a)=>{let o=new XMLHttpRequest;o.open("GET","data.json",!0),o.timeout=5e3,o.onload=function(){if(200===o.status)try{var e=JSON.parse(o.responseText);t(e)}catch(e){a(new Error("Failed to parse JSON: "+e.message))}else a(new Error("XHR failed with status: "+o.status))},o.onerror=function(){a(new Error("XHR request failed"))},o.ontimeout=function(){a(new Error("XHR request timed out"))},o.send()})}initializeComponents(){}}