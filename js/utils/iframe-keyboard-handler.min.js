class IframeKeyboardHandler{constructor(){this.iframe=null,this.isGameActive=!1,this.init()}init(){this.iframe=document.getElementById("game-iframe"),this.iframe&&(this.setupKeyboardHandling(),this.setupMessageHandling())}setupKeyboardHandling(){document.addEventListener("keydown",e=>{this.isGameActive&&this.iframe&&this.forwardKeyEvent(e,"keydown")}),document.addEventListener("keyup",e=>{this.isGameActive&&this.iframe&&this.forwardKeyEvent(e,"keyup")}),this.iframe.addEventListener("focus",()=>{this.isGameActive=!0}),this.iframe.addEventListener("blur",()=>{this.isGameActive=!1})}setupMessageHandling(){window.addEventListener("message",e=>{if("https://html5.gamemonetize.co"===e.origin)try{var t=e.data;switch(t.type){case"GAME_READY":this.isGameActive=!0,this.hideOverlay();break;case"GAME_ERROR":console.error("Game error:",t.error),this.handleGameError(t.error);break;case"GAME_LOADED":this.handleGameLoaded();break;case"REQUEST_FULLSCREEN":this.requestFullscreen()}}catch(e){console.warn("Error processing game message:",e)}})}forwardKeyEvent(e,t){try{var a=new KeyboardEvent(t,{key:e.key,code:e.code,keyCode:e.keyCode,which:e.which,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,altKey:e.altKey,metaKey:e.metaKey,bubbles:!0,cancelable:!0});this.iframe.contentWindow.document.dispatchEvent(a)}catch(e){console.debug("Could not forward key event to iframe:",e.message)}}hideOverlay(){var e=document.getElementById("game-overlay");e&&(e.style.display="none")}handleGameError(e){console.error("Game encountered an error:",e);var t,a,e=document.getElementById("adblock-warning");e&&(t=e.querySelector(".game-warning__title"),a=e.querySelector(".game-warning__text"),t&&(t.textContent="Game Error"),a&&(a.textContent="The game encountered an error. Please try refreshing the page or check your internet connection."),e.style.display="block")}handleGameLoaded(){this.isGameActive=!0,this.hideOverlay();var e=document.getElementById("game-wrapper");e&&e.classList.remove("loading")}requestFullscreen(){this.iframe&&this.iframe.requestFullscreen().catch(e=>{console.warn("Fullscreen request failed:",e)})}sendGameCommand(e,t={}){if(this.iframe&&this.iframe.contentWindow)try{this.iframe.contentWindow.postMessage({type:e,data:t,source:"parent"},"*")}catch(e){console.warn("Could not send command to game:",e)}}}document.addEventListener("DOMContentLoaded",()=>{new IframeKeyboardHandler});